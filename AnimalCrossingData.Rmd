---
title: "Animal Crossing Data"
output: html_document
---

```{r, warning = FALSE, message = FALSE}
# Load any R Packages you may need
library(tidyverse)
library(mdsr)
library(tidyverse)
library(gapminder)
library(data.table)
library(ngram)
library(gutenbergr)
library(tidytext)
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
critic <- readr::read_tsv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/critic.tsv')
user_reviews <- readr::read_tsv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/user_reviews.tsv')
items <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/items.csv')
villagers <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/villagers.csv')
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
View(critic)
View(user_reviews)
View(items)
View(villagers)
```

With the world currently in quarantine, many people are finding a way to kill time with Nintendo's latest release: "Animal Crossing: New Horizons"!
In this game, players escape to a deserted island where they beomce indebted to Tom Nook, a tanuki capitalist overlord who holds all of your mortgages. It is up to the player to run errand and to collect items such as fruits, insects and fish to sell to the tanuki in hopes of ever repaying their debt and earning new upgrades to make the island more beautful. In this game, you are in control of the isalnd and have the ability to design and decorate it in any way you like! You can also socialize with villagers who can give you new crafting recipes and gifts if you befriend them, or you can be mean an force them to leave the island if you dont like their personality.

As you might have figured out by now, this blog will be focusing on Animal Crossing data!

The data set we foung on Tidy Tuesday has 4 differnt sets within it: Items, Villagers, Critic reviews, and User reviews. In this blog we wil breaking up into differnt sections to explore each data set to answer some questions we may have and what we can discover from these datasets.

Let's start of with the items data!

*Items*

While looking over the items data set, we noticed that there are some duplicates of each item. So before we start working with the data, lets do some tidying up!

**Mini tidy data tutorial**
In Animal Crossing, ther are many differnet items in the game. But for the purpose of this blog and to make our lives easier, we will be focusing on the items that are categorized as furniture. 

Here we will filter out the table to focus on furniture:
```{r}
furniture_items = items %>%
  filter(category == "Furniture") %>%
  select(num_id, id, name, sell_value, buy_value)

#next use mutate to create a new column for the furniture_set and extract it from the part of the id before the - (use regex)

furniture_items
```

Now let's move on to the villager data!

*Villagers*
**Question: Are there more of a certain type of personality or is it evenly distributed?**
```{r}

villagers %>% 
  count(personality) %>% 
  arrange(desc(n))

```

Based of the new table, it looks like there doesn't seem to be an even distribution of personalities. Let's take a look at a graph:

**Creating a graph to show the distribuition of personalities**
```{r}
villagers %>% 
  count(personality) %>% 
  arrange(desc(n)) %>% 
  ggplot(aes(x = fct_reorder(personality,n), y = n))+
  geom_col(aes(fill = personality), alpha = 0.6)+
  labs(x = "Personality", y = "Number of Villagers")+
  geom_label(aes(label = n), size = 4, nudge_y = 7) +
  theme_minimal()+
  theme(legend.position = "none")+
  coord_flip()
```

According to the graph, it looks like the most common personality trait is lazy and the least common personality trait is uchi (uchi is a female villager personality. Ther are very caring and not too vain towards the villagers).

**Question: What is the distribution of personalities amongst differnt types of animals?**

First let's take a look at the distribution of species:
```{r}
villagers %>% 
  count(species) %>% 
  arrange(desc(n)) %>% 
  ggplot(aes(x = fct_reorder(species,n), y = n))+
  geom_col(aes(fill = species), alpha = 0.6)+
  labs(x = "Species", y = "Number of Villagers")+
  theme_minimal()+
  theme(legend.position = "none")+
  coord_flip()

```

It seems the 5 most common animals are: cats, rabbits, squirrels, frogs, and ducks.
Let's take a look into the personality districution of the most popular animal: cats!

```{r}
villagers_cats = villagers %>% 
  filter(species == "cat") %>% 
  count(personality) %>% 
  arrange(desc(n)) %>% 
  ggplot(aes(x = fct_reorder(personality, n), y = n))+
  geom_col(aes(fill = personality), alpha = 0.6)+
  labs(x = "Personality", y = "Number of Cat Villagers")+
  theme_minimal()+
  theme(legend.position = "none")+
  coord_flip()

villagers_cats
  
```

Now let's take a look at the other animals: rabbits, squirrels, frogs, and ducks!
```{r}
villagers_most_common = villagers %>% 
  filter(species %in% c("rabbit","squirrel","frog","duck")) %>% 
  group_by(species) %>% 
  count(personality) %>% 
  arrange(desc(n)) %>% 
  ggplot(aes(x = fct_reorder(personality, n), y = n))+
  geom_col(aes(fill = personality), alpha = 0.6)+
  labs(x = "Personality", y = "Number of Villagers")+
  geom_label(aes(label = n), size = 2.5, nudge_y = 7) +
  theme_minimal()+
  theme(legend.position = "none")+
  coord_flip()+
  facet_wrap(~species)

villagers_most_common
```

It looks like the type of personality each villager has based off of what type of aniaml they are is completly random.


Since many people are playing Animal Crossing, ,lets take a look to see what their opionons are and compare them to what critics think.

*Critic and user reviews*

With the critic and user reviews, we can do something similar to one of the homework assignments that we did in which we had to analyze some text data and whether they were negative or positive. We can use that to detect negative or positive reviews. 
We can also use the user reviews (0-10) and critic ratings to find the average rating(0-100)

```{r}
critic_reviews_tidy = critic %>%
  unnest_tokens(output = word, input = text)

critic_sentiment = critic_reviews_tidy %>%
  inner_join(get_sentiments("bing"), by = c("word" = "word"))

critic_sentiment

sentiment_counts = critic_sentiment %>%
  count(word, sentiment, sort = TRUE)
sentiment_counts %>%
  group_by(sentiment) %>%
  top_n(10, wt = n) %>%
  ggplot(aes(x = fct_reorder(word, n), y = n, 
             fill = sentiment)) + 
  geom_col() + 
  facet_wrap( ~ sentiment, scales = "free_y") + 
  labs(x = "", y = "Contribution to sentiment", 
       title = "Sentiment Analysis of Critic Reviews of Animal Crossing") +
  theme_bw() + 
  theme(legend.position = "none") +
  coord_flip()
```

